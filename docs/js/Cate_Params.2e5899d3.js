"use strict";(self["webpackChunkvue_shop"]=self["webpackChunkvue_shop"]||[]).push([[470],{1135:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("产品管理")]),e("el-breadcrumb-item",[t._v("产品分类")])],1),e("el-card",[e("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.showCateDialog("","add")}}},[t._v("添加分类")]),e("tree-table",{attrs:{data:t.cateList,columns:t.columns,"selection-type":!1,"expand-type":!1,"show-index":"",border:""},scopedSlots:t._u([{key:"isOK",fn:function(t){return[!1===t.row.cat_deleted?e("i",{staticClass:"el-icon-success isok",staticStyle:{width:"18px",height:"18px",color:"#4caf50"}}):e("i",{staticClass:"el-icon-error isok",staticStyle:{width:"18px",height:"18px",color:"#ff9800"}})]}},{key:"order",fn:function(a){return[0===a.row.cat_level?e("el-tag",{attrs:{type:"",effect:"plain"}},[t._v("一级")]):t._e(),1===a.row.cat_level?e("el-tag",{attrs:{type:"success",effect:"plain"}},[t._v("二级")]):t._e(),2===a.row.cat_level?e("el-tag",{attrs:{type:"warning",effect:"plain"}},[t._v("三级")]):t._e()]}},{key:"option",fn:function(a){return[e("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.showCateDialog(a.row,"edit")}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.deleteCate(a.row)}}},[t._v("删除")])]}}])}),e("el-pagination",{attrs:{"current-page":t.queryInfo.pagenum,"page-sizes":[2,5,10,15],"page-size":t.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{title:t.cateDialogTitle+"分类",visible:t.cateDialogVisible},on:{"update:visible":function(e){t.cateDialogVisible=e},close:t.cateDialogClosed}},[e("el-form",{ref:"cateDialogFormRef",attrs:{model:t.cateDialogForm,rules:t.cateDialogFormRules,"label-width":"100px"}},["添加"===t.cateDialogTitle?e("el-form-item",{attrs:{label:"选择父级"}},[e("el-cascader",{attrs:{options:t.cateParentList,props:t.cascaderProps,clearable:""},on:{change:t.handleCateChange},model:{value:t.cateParentListSelect,callback:function(e){t.cateParentListSelect=e},expression:"cateParentListSelect"}})],1):t._e(),e("el-form-item",{attrs:{label:"分类名称",prop:"cat_name"}},[e("el-input",{model:{value:t.cateDialogForm.cat_name,callback:function(e){t.$set(t.cateDialogForm,"cat_name",e)},expression:"cateDialogForm.cat_name"}})],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.cateDialogVisible=!1}}},[t._v("取 消")]),"添加"===t.cateDialogTitle?e("el-button",{attrs:{type:"primary"},on:{click:t.addCate}},[t._v("确 定")]):"编辑"===t.cateDialogTitle?e("el-button",{attrs:{type:"primary"},on:{click:t.editCate}},[t._v("确 定")]):t._e()],1)],1)],1)},s=[],l={data(){return{queryInfo:{type:3,pagenum:1,pagesize:5},cateList:[],total:0,columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",type:"template",template:"isOK"},{label:"排序",type:"template",template:"order"},{label:"操作",type:"template",template:"option"}],cateDialogVisible:!1,cateDialogTitle:"",cateDialogForm:{cat_pid:0,cat_name:"",cat_level:0},cat_id:"",cateDialogFormRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},cateParentList:[],cateParentListSelect:[],cascaderProps:{value:"cat_id",label:"cat_name",children:"children",checkStrictly:!0}}},created(){this.getCateList()},methods:{async getCateList(){const{data:t}=await this.$http.get("categories",{params:this.queryInfo});if(200!==t.meta.status)return this.$message.error(t.meta.msg);this.cateList=t.data.result,this.total=t.data.total},handleSizeChange(t){this.queryInfo.pagesize=t,this.getCateList()},handleCurrentChange(t){this.queryInfo.pagenum=t,this.getCateList()},async getParentCateList(){const{data:t}=await this.$http.get("categories",{params:{type:2}});if(200!==t.meta.status)return this.$message.error(t.meta.msg);this.cateParentList=t.data},showCateDialog(t,e){"add"===e?this.cateDialogTitle="添加":"edit"===e&&(this.cateDialogTitle="编辑",this.cat_id=t.cat_id,this.cateDialogForm.cat_name=t.cat_name),this.getParentCateList(),this.cateDialogVisible=!0},handleCateChange(t){this.cateParentListSelect.length>0?(this.cateDialogForm.cat_pid=this.cateParentListSelect[this.cateParentListSelect.length-1],this.cateDialogForm.cat_level=this.cateParentListSelect.length):(this.cateDialogForm.cat_pid=0,this.cateDialogForm.cat_level=0)},addCate(){this.$refs.cateDialogFormRef.validate((async t=>{if(!t)return this.$message.error("请输入信息");const{data:e}=await this.$http.post("categories",this.cateDialogForm);if(201!==e.meta.status)return this.$message.error(e.meta.msg);this.getCateList(),this.cateDialogVisible=!1,this.$message.success(e.meta.msg)}))},async editCate(){this.$refs.cateDialogFormRef.validate((async t=>{if(!t)return this.$message.error("请输入信息");const{data:e}=await this.$http.put(`categories/${this.cat_id}`,{cat_name:this.cateDialogForm.cat_name});if(200!==e.meta.status)return this.$message.error(e.meta.msg);this.getCateList(),this.cateDialogVisible=!1,this.$message.success(e.meta.msg)}))},cateDialogClosed(){this.$refs.cateDialogFormRef.resetFields(),this.cateParentListSelect=[],this.cateDialogForm.cat_pid=0,this.cateDialogForm.cat_level=0,this.cateDialogForm.cat_name=""},async deleteCate(t){const{data:e}=await this.$http.delete(`categories/${t.cat_id}`);if(200!==e.meta.status)return this.$message.error(e.meta.msg);this.getCateList(),this.$message.success(e.meta.msg)}}},r=l,n=a(1001),o=(0,n.Z)(r,i,s,!1,null,"313a2389",null),c=o.exports},7243:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("产品管理")]),e("el-breadcrumb-item",[t._v("参数列表")])],1),e("el-card",[e("el-alert",{attrs:{title:"注意：只允许修改第三级的分类设置相关参数",type:"warning","show-icon":"",closable:!1}}),e("el-row",[e("el-col",{attrs:{span:3}},[e("span",[t._v("选择产品分类：")])]),e("el-col",{attrs:{span:9}},[e("el-cascader",{attrs:{options:t.catelist,props:t.cateProps,clearable:""},on:{change:t.handleCateChange},model:{value:t.selectCateKeys,callback:function(e){t.selectCateKeys=e},expression:"selectCateKeys"}})],1)],1),e("el-tabs",{on:{"tab-click":t.handleTabsClick},model:{value:t.tabsActive,callback:function(e){t.tabsActive=e},expression:"tabsActive"}},[e("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:"",disabled:t.isBtnDisable},on:{click:function(e){return t.showDialog("","add")}}},[t._v("添加参数")]),e("el-table",{attrs:{data:t.cateManyList,border:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._l(a.row.attr_vals,(function(i,s){return e("el-tag",{key:s,attrs:{type:"",closable:""},on:{close:function(e){return t.handleTagClose(a.row,s)}}},[t._v(" "+t._s(i))])})),a.row.inputVisible?e("el-input",{ref:"saveTagInput",staticClass:"inputnewtag",attrs:{size:"small"},on:{blur:function(e){return t.handleInputConfirm(a.row)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(a.row)}},model:{value:a.row.inputValue,callback:function(e){t.$set(a.row,"inputValue",e)},expression:"scope.row.inputValue"}}):t._e(),e("el-button",{staticClass:"button-new-tag",attrs:{size:"small",disabled:a.row.inputVisible},on:{click:function(e){return t.showInput(a.row)}}},[t._v("+ 添加")])]}}])}),e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.showDialog(a.row,"edit")}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.delAttr(a.row)}}},[t._v("删除")])]}}])})],1)],1),e("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:"",disabled:t.isBtnDisable},on:{click:function(e){return t.showDialog("","add")}}},[t._v("添加属性")]),e("el-table",{attrs:{data:t.cateOnlyList,border:""}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._l(a.row.attr_vals,(function(i,s){return e("el-tag",{key:s,attrs:{type:"",closable:""},on:{close:function(e){return t.handleTagClose(a.row,s)}}},[t._v(" "+t._s(i))])})),a.row.inputVisible?e("el-input",{ref:"saveTagInput",staticClass:"inputnewtag",attrs:{size:"small"},on:{blur:function(e){return t.handleInputConfirm(a.row)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(a.row)}},model:{value:a.row.inputValue,callback:function(e){t.$set(a.row,"inputValue",e)},expression:"scope.row.inputValue"}}):t._e(),e("el-button",{staticClass:"button-new-tag",attrs:{size:"small",disabled:a.row.inputVisible},on:{click:function(e){return t.showInput(a.row)}}},[t._v("+ 添加")])]}}])}),e("el-table-column",{attrs:{label:"序号",type:"index"}}),e("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.showDialog(a.row,"edit")}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.delAttr(a.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),e("el-dialog",{attrs:{title:t.dialogTitleFirst+t.dialogTitle,visible:t.dialogVisible},on:{closed:t.dialogClosed}},[e("el-form",{ref:"dialogFormRef",attrs:{model:t.dialogForm,rules:t.dialogFormRules}},[e("el-form-item",{attrs:{label:t.dialogTitle+"：",prop:"attr_name"}},[e("el-input",{attrs:{placeholder:"请输入"+t.dialogTitle},model:{value:t.dialogForm.attr_name,callback:function(e){t.$set(t.dialogForm,"attr_name",e)},expression:"dialogForm.attr_name"}})],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),"添加"==t.dialogTitleFirst?e("el-button",{attrs:{type:"primary"},on:{click:t.dialogSub}},[t._v("确 定")]):e("el-button",{attrs:{type:"primary"},on:{click:t.dialogEditSub}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"动态参数",visible:t.manyDialogVisible}},[e("div",[t._v(" 动态参数： "),e("el-input",{attrs:{placeholder:"请输入动态参数"}})],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.manyDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.manyDialogVisible=!1}}},[t._v("确 定")])],1)]),e("el-dialog",{attrs:{title:"静态属性",visible:t.onlyDialogVisible}},[e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.onlyDialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.onlyDialogVisible=!1}}},[t._v("确 定")])],1)])],1)},s=[],l={data(){return{catelist:[],cateProps:{value:"cat_id",label:"cat_name",children:"children",expandTrigger:"hover"},selectCateKeys:[],tabsActive:"many",cateOnlyList:[],cateManyList:[],dialogVisible:!1,dialogTitleFirst:"",dialogForm:{attr_name:""},attrId:"",dialogFormRules:{attr_name:[{required:!0,message:"必填项不能为空 ",trigger:"blur"}]},manyDialogVisible:!1,onlyDialogVisible:!1}},created(){this.getCateList()},computed:{isBtnDisable(){return 3!==this.selectCateKeys.length},creatId(){return 3===this.selectCateKeys.length?this.selectCateKeys[2]:null},dialogTitle(){return"many"===this.tabsActive?"动态参数":"静态属性"}},methods:{async getCateList(){const{data:t}=await this.$http.get("categories");if(200!==t.meta.status)return this.$message.error(t.meta.msg);this.catelist=t.data},handleCateChange(){3!==this.selectCateKeys.length?(this.selectCateKeys=[],this.cateOnlyList=[],this.cateManyList=[],this.$message.error("只允许修改第三级的分类设置相关参数")):this.getCateAttributesList(this.selectCateKeys[2],"many")},handleTabsClick(t,e){3===this.selectCateKeys.length&&("0"===t.index?this.getCateAttributesList(this.selectCateKeys[2],"many"):"1"===t.index&&this.getCateAttributesList(this.selectCateKeys[2],"only"))},async getCateAttributesList(t,e){const{data:a}=await this.$http.get(`categories/${t}/attributes`,{params:{sel:e}});if(200!==a.meta.status)return this.$message.error(a.meta.msg);a.data.forEach((t=>{t.attr_vals=t.attr_vals?t.attr_vals.split(" "):[],t.inputVisible=!1,t.inputValue=""})),"only"===e?this.cateOnlyList=a.data:"many"===e&&(this.cateManyList=a.data)},showDialog(t,e){this.dialogVisible=!0,"add"===e?this.dialogTitleFirst="添加":"edit"===e&&(this.dialogTitleFirst="编辑"),this.attrId=t.attr_id,this.dialogForm.attr_name=t.attr_name},dialogClosed(){this.$refs.dialogFormRef.resetFields()},dialogSub(){this.$refs.dialogFormRef.validate((async t=>{if(!t)return this.$message.error("请输入内容");const{data:e}=await this.$http.post(`categories/${this.creatId}/attributes`,{attr_name:this.dialogForm.attr_name,attr_sel:this.tabsActive});if(201!==e.meta.status)return this.$message.error(e.meta.msg);this.dialogVisible=!1,this.getCateAttributesList(this.creatId,this.tabsActive),this.$message.success(e.meta.msg)}))},dialogEditSub(){this.$refs.dialogFormRef.validate((async t=>{if(!t)return this.$message.error("请输入内容");const{data:e}=await this.$http.put(`categories/${this.creatId}/attributes/${this.attrId}`,{attr_name:this.dialogForm.attr_name,attr_sel:this.tabsActive});if(200!==e.meta.status)return this.$message.error(e.meta.msg);this.dialogVisible=!1,this.getCateAttributesList(this.creatId,this.tabsActive),this.$message.success(e.meta.msg)}))},async delAttr(t){const e=await this.$confirm("此操作将永久删除该文件，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((t=>{}));if("confirm"!==e)return this.$message.info("取消了删除");const{data:a}=await this.$http.delete(`categories/${this.creatId}/attributes/${t.attr_id}`);if(200!==a.meta.status)return this.$message.error(a.meta.msg);this.getCateAttributesList(this.creatId,this.tabsActive),this.$message.success(a.meta.msg)},handleTagClose(t,e){t.attr_vals.splice(e,1),this.editArrtr(t)},showInput(t){t.inputVisible=!0,this.$nextTick((t=>{this.$refs.saveTagInput.$refs.input.focus()}))},async handleInputConfirm(t){if(0===t.inputValue.trim().length)return t.inputValue="",void(t.inputVisible=!1);t.attr_vals.push(t.inputValue.trim()),t.inputValue="",t.inputVisible=!1,this.editArrtr(t)},async editArrtr(t){const{data:e}=await this.$http.put(`categories/${this.creatId}/attributes/${t.attr_id}`,{attr_name:t.attr_name,attr_sel:t.attr_sel,attr_vals:t.attr_vals.join(" ")});if(200!==e.meta.status)return this.$message.error(e.meta.msg);this.getCateAttributesList(this.creatId,this.tabsActive),this.$message.success(e.meta.msg)},showManyDialog(t,e){this.manyDialogVisible=!0},showOnlyDialog(t,e){this.onlyDialogVisible=!0}}},r=l,n=a(1001),o=(0,n.Z)(r,i,s,!1,null,"404f1608",null),c=o.exports}}]);
//# sourceMappingURL=Cate_Params.2e5899d3.js.map